- Create a function to deal with timeout and failures apart.
- Add a save procedure.
